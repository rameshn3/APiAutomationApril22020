package Surveys;

import static io.restassured.RestAssured.given;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;
import java.util.TreeMap;
import java.util.stream.Collectors;

//import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.json.JSONArray;
import org.json.JSONObject;
import org.testng.annotations.BeforeClass;
//import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;

import io.restassured.RestAssured;
import io.restassured.base.TestBase;
import io.restassured.http.ContentType;
import io.restassured.path.json.JsonPath;
import io.restassured.response.Response;

public class SurveyGetParamTest extends TestBase {

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-117.xlsx";
	 * 
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\117 - Anxiety - Caregiver Survey.xlsx"
	 * ;
	 */

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-92.xlsx";
	 * 
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\92 - PHQ-9.xlsx"
	 * ;
	 */

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-72.xlsx";
	 * 
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\72 - Anxiety - Patient Self-report.xlsx"
	 * ;
	 */

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-53.xlsx";
	 * 
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\53 - ADHD - Patient self-report - Visit-based Survey.xlsx"
	 * ;
	 */

	/*
	 * private String trivoxSurveyDataFilePath =
	 * "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-106.xlsx";
	 * private String metadata_fpath =
	 * "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\106 - Autism - ASD-PROM - Standalone.xlsx"
	 * ;
	 */
	
	private String trivoxSurveyDataFilePath ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-206.xlsx";
	private String metadata_fpath="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\206 - asap_survey_patient.xlsx";
	

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-207.xlsx";
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\207 - asap_survey_101817.xlsx"
	 * ;
	 */

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-209.xlsx";
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\209 - asap_last_test_parent.xlsx"
	 * ;
	 */

	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-138.xlsx";
	 * private String metadata_fpath
	 * ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\138 - Downs Syndrome - ASD-PROM Standalone - Caregiver.xlsx"
	 * ;
	 */
	// private String trivoxSurveyDataFilePath
	// ="C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-224.xlsx";
	// private String metadata_fpath =
	// "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\224
	// - DMC Intake - Teacher Survey.xlsx";

/*	private String trivoxSurveyDataFilePath = "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-38.xlsx";
	private String metadata_fpath = "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\38 - ADHD - Teacher Survey.xlsx";
	*/
	/*
	 * private String trivoxSurveyDataFilePath
	 * ="C:/VetaHealth/MigrationComparision/ExcelSurveys/OneDrive_2019-10-11/Prod Deidentified/survey-38.xlsx"
	 * ; private String metadata_fpath
	 * ="C:/VetaHealth/MigrationComparision/ExcelSurveys/Stage3/38 - ADHD - Teacher Survey.xlsx"
	 * ;
	 */
	
	/* private String trivoxSurveyDataFilePath = "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\trivox-survey-36-2.xlsx";
	 private String metadata_fpath = "C:\\VetaHealth\\SurveyDataMigrationVerificaitonDataMarch162020\\Trivox\\metadata\\36 - ADHD - Caregiver - Visit-based Survey.xlsx";
	*/
	
	/*
	 * private String trivoxSurveyDataFilePath =
	 * "C:/VetaHealth/MigrationComparision/ExcelSurveys/OneDrive_2019-10-11/sourceExcelFiles/survey-36-3.xlsx";
	 * private String metadata_fpath =
	 * "C:/VetaHealth/MigrationComparision/ExcelSurveys/Stage3/36 - ADHD - Caregiver - Visit-based Survey.xlsx"
	 * ;
	 */
	// private String surveyid = "117";
	// private String surveyid = "92";
	// private String surveyid = "72";
	// private String surveyid = "53";
	// private String surveyid = "106";
	 private String surveyid = "206";
	// private String surveyid = "207";
	// private String surveyid = "209";
	// private String surveyid = "138";
	// private String surveyid = "224";
	//private String surveyid = "38";
	//private String surveyid = "36";
	private Map<String, String> surveySkippedScreeningIds = new HashMap<>();

	public SurveyGetParamTest() throws IOException {
		super();
		// TODO Auto-generated constructor stub

		// surveySkippedScreeningIds.put("117","26215,26452,26661,26662,26780,26909,27429,27466,27663,27788,28457,29698,29727,31077,32400,33313,33357,33672,33864,34151,34358,35142,35939,35999,36098,36695,38237,38931,38959,40074,42257,43410,44483,44550,44840,44842,45105,45177,45468,47510,49214,49285,49406,49989,50861,52161,52720,52900,53694,55547,55879,56176,56510,56731,57764,57981,58320,58830,59600,60207,60400,60812,60890,61037,61711,63043,63165,63493,63616,63829,64105,64183,64393,64623,64659,64870,68023,69153,69450,70015,70477,70590,71946,72085,72475,74026,74359,75818,75879,78365,79753,79985,81671,81851,82783,83684,83759,83797,84256,84449,84503,84842,84923,85044,85997,86046,86089,86201,87279,87384,87644,88325,88407,89722,89932,91341,92462,93218,93572,93935");
		// surveySkippedScreeningIds.put("106","39071,41012,42535,42663,43368,43447,44271,44279,44426,44472,44491,44584,44588,44646,44699,44754,44824,44886,44954,45245,47530,47895,50154,50653,51351,51415,51438,51496,51603,51821,51822,52897,53634,54019,54521,54882,55047,55434,55622,56264,56510,56790,57632,57993,58103,58876,59600,59702,60969,61221,62368,63389,63683,63895,63919,64011,64012,64092,64096,64244,64480,68116,69148,72587,73061,73345,73408,74546,74690,74737,75737,76074,76247,76724,77467,78030,78037,78202,78220,78518,78779,79889,81653,81695,81911,81925,82025,82757,82812,83383,83930,85303,85696,85893,86836,87399,87949,89241,90424,90987,91844,93202,93371,93382,93614,93858,93960,93971,93994,94011,67432");
		// surveySkippedScreeningIds.put("53","13885,15651,16170,19018,20035,21060,21227,22006,22568,23366,28740,30488,35721,38074,38578,39975,40125,42142,43338,45180,54406,61348,72488,73721,74712,74909,75294,76677,77466,81232,81300,82634,91423,93945");
		// surveySkippedScreeningIds.put("138","67313,67317,67375,67387,67447,67654,69531,71115,72305,72981,73033,76058,76359,76604,76987,77155,77642,77667,77891,78561,78702,78837,80860,81219,81508,81603,81844,82533,82714,82960,85348,85944,86218,86692,86850,86882,87524,89255,91508,91807,91958,92166,92294,92295,92706,93764,93766");
		// surveySkippedScreeningIds.put("224","90975");
		// surveySkippedScreeningIds.put("92","48506");
		// surveySkippedScreeningIds.put("72","24662,44471");
		 surveySkippedScreeningIds.put("206","");
		// surveySkippedScreeningIds.put("207","");
		// surveySkippedScreeningIds.put("209","");
		//surveySkippedScreeningIds.put("38",
		//		"7,11,13,15,21,23,24,25,27,28,32,34,35,37,53,55,56,57,59,65,68,71,80,82,84,93,94,98,99,103,106,117,122,123,125,126,133,165,188,189,191,195,196,197,198,199,203,205,212,216,219,223,224,225,227,229,230,233,234,235,237,238,249,254,255,259,260,261,262,264,265,268,269,271,272,274,275,278,281,284,286,288,289,290,291,292,293,294,295,298,299,301,302,317,318,319,321,323,324,326,328,329,330,331,335,339,344,345,346,349,350,351,358,359,366,370,371,374,376,378,379,380,389,392,393,396,397,399,400,404,406,407,413,414,416,419,424,425,426,427,431,432,433,434,435,441,445,452,457,458,460,466,467,475,486,533,540,548,552,560,562,564,567,568,569,572,576,582,583,585,586,594,596,598,599,600,601,602,603,605,608,610,611,615,622,625,647,649,650,655,656,657,660,663,664,665,667,668,669,677,678,679,680,681,683,684,685,688,689,691,694,699,703,704,705,706,710,712,715,716,719,723,724,725,731,732,733,734,736,744,745,751,753,755,766,768,790,792,796,797,810,813,817,820,832,834,835,838,839,841,843,844,845,846,847,848,849,850,851,856,863,864,865,866,867,868,869,870,873,874,878,880,881,882,885,889,890,891,893,897,898,900,901,908,912,917,918,920,923,925,927,929,932,933,939,941,942,944,945,946,947,950,951,952,953,955,956,959,960,962,963,965,968,970,971,972,973,974,976,977,978,981,982,983,984,986,987,988,994,995,996,1002,1007,1008,1009,1011,1013,1021,1024,1025,1027,1029,1039,1040,1043,1044,1045,1046,1047,1050,1051,1052,1055,1059,1061,1062,1063,1066,1067,1070,1071,1072,1115,1116,1117,1118,1119,1122,1123,1126,1127,1128,1132,1136,1143,1144,1146,1147,1149,1152,1156,1158,1159,1160,1161,1163,1164,1172,1178,1181,1184,1185,1186,1189,1200,1201,1202,1204,1206,1207,1208,1220,1224,1229,1230,1232,1238,1240,1242,1244,1252,1255,1261,1262,1265,1266,1267,1271,1272,1275,1291,1296,1297,1298,1301,1310,1313,1315,1317,1325,1327,1328,1335,1337,1339,1340,1343,1370,1371,1374,1380,1381,1384,1386,1390,1391,1397,1398,1403,1405,1417,1418,1419,1420,1421,1423,1424,1425,1427,1428,1429,1432,1434,1437,1438,1439,1440,1443,1445,1448,1449,1450,1456,1457,1460,1462,1463,1465,1466,1469,1470,1471,1473,1476,1478,1481,1484,1492,1497,1498,1500,1501,1506,1508,1510,1513,1517,1518,1521,1523,1524,1525,1526,1527,1529,1535,1536,1537,1538,1539,1542,1543,1544,1548,1550,1556,1558,1562,1565,1574,1576,1579,1580,1581,1587,1598,1599,1600,1601,1605,1622,1623,1624,1625,1626,1628,1629,1634,1637,1640,1649,1650,1656,1658,1660,1663,1667,1670,1671,1675,1676,1680,1681,1682,1684,1685,1687,1689,1691,1692,1694,1695,1696,1697,1699,1737,1738,1740,1741,1742,1743,1745,1752,1754,1757,1759,1761,1764,1769,1770,1773,1779,1787,1789,1796,1799,1802,1803,1805,1806,1808,1810,1819,1820,1821,1823,1827,1828,1829,1831,1833,1834,1835,1836,1840,1841,1842,1845,1846,1850,1851,1852,1853,1856,1857,1859,1860,1863,1864,1867,1869,1871,1872,1873,1874,1877,1878,1879,1881,1882,1883,1889,1891,1892,1897,1900,1901,1902,1906,1907,1908,1910,1911,1919,1920,1921,1922,1925,1926,1929,1934,1938,1940,1941,1942,1944,1946,1947,1949,1951,1952,1957,1958,1962,1963,1965,1966,1968,1969,1970,1973,1992,1993,1998,1999,2000,2007,2012,2014,2016,2017,2025,2028,2033,2034,2036,2041,2042,2047,2051,2052,2054,2056,2057,2058,2059,2061,2069,2072,2074,2075,2077,2080,2082,2088,2109,2147,2151,2152,2164,2167,2181,2182,2183,2186,2187,2190,2196,2198,2200,2232,2238,2240,2250,2277,2281,2286,2296,2297,2299,2301,2302,2311,2315,2317,2322,2329,2338,2339,2340,2344,2347,2349,2352,2353,2355,2360,2364,2366,2371,2375,2376,2377,2378,2379,2380,2382,2385,2386,2389,2390,2392,2407,2413,2423,2429,2436,2439,2442,2445,2448,2450,2454,2455,2460,2461,2462,2465,2468,2471,2475,2477,2478,2484,2489,2493,2494,2495,2496,2500,2501,2502,2508,2509,2522,2523,2524,2525,2526,2537,2544,2570,2573,2586,2590,2593,2595,2596,2599,2600,2601,2602,2603,2604,2606,2611,2614,2620,2623,2624,2626,2627,2628,2630,2635,2641,2643,2644,2647,2648,2652,2653,2654,2657,2659,2660,2661,2668,2671,2672,2673,2675,2680,2684,2685,2686,2691,2692,2694,2697,2701,2703,2706,2708,2711,2712,2718,2719,2725,2726,2729,2730,2732,2733,2738,2742,2743,2745,2747,2748,2750,2755,2757,2758,2760,2764,2765,2767,2771,2774,2775,2776,2777,2783,2784,2785,2786,2787,2788,2789,2790,2792,2794,2798,2800,2803,2804,2805,2806,2807,2808,2809,2811,2814,2817,2820,2823,2824,2829,2833,2838,2839,2843,2846,2847,2849,2851,2852,2853,2854,2858,2859,2861,2864,2866,2869,2871,2873,2874,2875,2881,2885,2886,2889,2893,2895,2898,2902,2908,2911,2913,2914,2920,2923,2925,2926,2927,2928,2929,2930,2932,2933,2936,2942,2945,2948,2950,2951,2952,2955,2959,2961,2962,2966,2967,2968,2969,2970,2971,2979,2980,2985,2987,2989,2997,2998,3006,3008,3010,3013,3014,3019,3020,3024,3026,3028,3029,3031,3035,3038,3039,3042,3046,3047,3049,3052,3053,3054,3059,3061,3062,3063,3064,3067,3068,3072,3076,3083,3087,3088,3092,3095,3097,3098,3100,3102,3103,3105,3114,3115,3116,3120,3121,3124,3130,3133,3137,3167,3179,3469,3490,3496,3506,3523,3529,3552,3560,3572,3573,3574,3577,3580,3582,3583,3587,3592,3595,3597,3611,3623,3626,3629,3632,3637,3642,3643,3645,3647,3648,3652,3657,3665,3667,3674,3677,3680,3709,3710,3713,3727,3729,3734,3740,3742,3744,3748,3756,3759,3762,3764,3772,3773,3782,3784,3785,3818,3827,3831,3839,3840,3841,3853,3855,3861,3874,3875,3885,3886,3893,3897,3903,3909,3915,3916,3917,3931,3940,3941,3942,3943,3946,3947,3956,3961,3966,3971,3977,3983,3984,4002,4003,4004,4005,4007,4008,4009,4012,4013,4016,4017,4018,4021,4024,4030,4032,4036,4043,4047,4055,4059,4061,4066,4067,4071,4074,4075,4078,4085,4087,4089,4096,4101,4108,4113,4117,4118,4119,4121,4131,4142,4145,4147,4149,4150,4152,4153,4155,4158,4159,4165,4168,4170,4174,4175,4187,4192,4193,4200,4209,4212,4226,4229,4234,4235,4236,4237,4247,4255,4261,4265,4271,4274,4281,4283,4285,4293,4295,4298,4307,4310,4311,4315,4318,4328,4329,4334,4343,4344,4351,4356,4365,4368,4376,4379,4390,4392,4398,4400,4411,4417,4418,4424,4432,4434,4437,4438,4448,4449,4450,4452,4458,4463,4473,4475,4476,4480,4483,4488,4493,4498,4499,4500,4502,4505,4506,4508,4509,4510,4512,4515,4519,4522,4525,4529,4531,4537,4543,4547,4549,4550,4557,4560,4569,4574,4581,4610,4611,4618,4627,4630,4636,4638,4639,4641,4642,4647,4658,4672,4674,4691,4692,4695,4703,4715,4716,4717,4719,4722,4724,4725,4727,4735,4742,4749,4762,4769,4771,4776,4777,4782,4786,4787,4800,4803,4805,4807,4813,4820,4822,4823,4832,4835,4837,4839,4846,4850,4853,4858,4860,4862,4868,4870,4874,4875,4894,4895,4905,4908,4910,4911,4914,4924,4931,4934,4938,4941,4952,4954,4967,4968,4969,4975,4980,4981,4983,4988,4995,4997,4999,5002,5012,5017,5025,5026,5028,5029,5030,5033,5039,5042,5043,5050,5051,5066,5068,5073,5079,5086,5088,5090,5097,5098,5103,5104,5113,5115,5120,5126,5129,5131,5135,5139,5141,5144,5146,5149,5151,5158,5159,5164,5166,5173,5182,5183,5185,5187,5200,5204,5207,5209,5210,5211,5212,5213,5226,5229,5238,5244,5252,5257,5275,5279,5429,5432,5462,5470,5496,5497,5510,5512,5518,5525,5529,5546,5556,5560,5575,5581,5590,5591,5594,5597,5600,5610,5613,5614,5616,5617,5622,5628,5629,5633,5634,5635,5639,5640,5644,5652,5657,5663,5665,5666,5677,5693,5698,5699,5702,5715,5719,5722,5728,5730,5731,5734,5735,5737,5741,5742,5744,5745,5747,5748,5749,5750,5751,5758,5759,5761,5762,5763,5764,5767,5769,5773,5782,5785,5794,5811,5818,5821,5822,5828,5837,5839,5842,5844,5850,5853,5856,5865,5868,5881,5882,5907,5910,5921,5922,5929,5930,5933,5934,5938,5956,5959,5960,5961,5962,5964,5965,5973,5975,5985,5987,5989,5993,5997,6003,6004,6005,6006,6010,6013,6020,6022,6031,6032,6034,6036,6038,6039,6040,6041,6042,6044,6046,6051,6052,6057,6058,6060,6064,6065,6066,6068,6069,6071,6077,6082,6084,6089,6100,6103,6109,6112,6113,6117,6118,6123,6127,6128,6131,6134,6135,6141,6145,6149,6153,6154,6155,6156,6157,6158,6162,6163,6164,6165,6166,6167,6171,6172,6173,6175,6176,6177,6178,6179,6181,6187,6188,6193,6194,6196,6201,6203,6204,6209,6212,6215,6216,6218,6219,6221,6222,6230,6232,6237,6239,6242,6243,6245,6247,6251,6254,6257,6265,6266,6267,6270,6274,6275,6279,6282,6283,6287,6289,6290,6293,6296,6303,6309,6311,6312,6317,6318,6325,6328,6336,6350,6353,6357,6360,6366,6367,6370,6381,6386,6387,6391,6392,6394,6397,6400,6402,6408,6414,6415,6417,6419,6420,6422,6423,6424,6426,6427,6430,6432,6434,6438,6441,6443,6444,6445,6448,6450,6455,6461,6462,6463,6468,6470,6472,6479,6480,6483,6491,6495,6498,6502,6506,6508,6509,6515,6516,6517,6518,6520,6523,6524,6529,6531,6532,6533,6534,6535,6540,6541,6543,6544,6545,6546,6547,6548,6551,6553,6556,6557,6559,6562,6563,6566,6567,6570,6571,6583,6585,6588,6592,6593,6595,6596,6598,6599,6607,6608,6613,6615,6617,6621,6636,6638,6643,6644,6648,6650,6652,6656,6661,6665,6666,6668,6672,6676,6689,6691,6692,6693,6694,6704,6711,6722,6727,6731,6734,6735,6745,6748,6751,6752,6756,6757,6759,6760,6762,6764,6766,6767,6770,6771,6772,6775,6777,6781,6786,6787,6796,6798,6804,6806,6807,6809,6812,6818,6819,6820,6825,6827,6830,6832,6837,6842,6845,6846,6849,6850,6852,6854,6855,6856,6860,6862,6863,6867,6875,6877,6890,6891,6892,6893,6902,6908,6912,6917,6924,6927,6929,6936,6938,6941,6942,6943,6957,6964,6971,6974,6979,6985,6986,6987,6988,6994,6999,7001,7002,7004,7005,7006,7016,7018,7026,7028,7029,7030,7031,7037,7040,7041,7047,7052,7056,7059,7061,7062,7064,7067,7070,7071,7073,7074,7084,7086,7089,7091,7092,7093,7095,7096,7097,7100,7101,7106,7107,7109,7112,7116,7117,7120,7124,7131,7133,7136,7138,7143,7150,7153,7156,7159,7160,7167,7169,7172,7179,7183,7197,7202,7205,7206,7208,7211,7216,7217,7218,7220,7222,7223,7224,7231,7238,7239,7242,7245,7246,7248,7253,7255,7256,7270,7271,7272,7275,7277,7285,7287,7291,7297,7299,7304,7305,7306,7307,7313,7325,7326,7330,7341,7353,7356,7370,7372,7385,7396,7404,7407,7412,7414,7416,7419,7428,7430,7432,7434,7446,7449,7461,7466,7486,7752,7758,7774,7789,7820,7828,7841,7872,7873,7897,7898,7903,7904,7905,7906,7911,7917,7918,7920,7923,7925,7928,7929,7934,7938,7943,7946,7947,7953,7956,7957,7960,7961,7962,7965,7969,7973,7980,7981,7983,7987,8000,8003,8006,8028,8039,8046,8047,8049,8053,8054,8055,8057,8061,8062,8063,8064,8065,8066,8069,8070,8079,8081,8091,8098,8104,8109,8114,8120,8127,8130,8132,8134,8141,8142,8145,8148,8157,8166,8168,8169,8172,8174,8176,8179,8181,8182,8185,8191,8192,8193,8195,8201,8205,8208,8213,8234,8237,8238,8243,8244,8245,8247,8248,8249,8257,8258,8259,8262,8264,8268,8271,8276,8277,8279,8280,8281,8283,8287,8288,8291,8293,8295,8296,8306,8316,8317,8318,8323,8326,8327,8328,8330,8336,8337,8338,8340,8347,8348,8349,8357,8359,8362,8363,8364,8365,8369,8370,8381,8384,8392,8397,8399,8401,8403,8407,8409,8411,8416,8423,8424,8425,8427,8430,8433,8434,8435,8436,8438,8441,8443,8444,8446,8447,8449,8452,8455,8457,8461,8463,8468,8469,8470,8474,8484,8486,8487,8490,8491,8495,8499,8506,8513,8517,8523,8524,8529,8536,8537,8541,8543,8545,8546,8548,8560,8563,8569,8571,8573,8574,8575,8578,8585,8588,8590,8593,8594,8598,8599,8601,8602,8603,8605,8607,8610,8611,8612,8613,8614,8615,8616,8621,8623,8624,8625,8626,8627,8628,8630,8631,8632,8633,8634,8635,8636,8638,8639,8648,8655,8656,8662,8666,8671,8679,8689,8691,8692,8696,8698,8699,8705,8707,8708,8709,8717,8722,8723,8729,8730,8732,8735,8738,8747,8751,8753,8756,8760,8763,8773,8775,8776,8779,8782,8785,8786,8789,8792,8793,8794,8795,8798,8799,8806,8808,8811,8814,8837,8840,8842,8843,8844,8846,8847,8850,8851,8854,8857,8858,8859,8868,8873,8874,8877,8878,8881,8882,8883,8890,8891,8894,8895,8896,8900,8910,8911,8912,8914,8915,8920,8927,8931,8932,8933,8941,8948,8949,8950,8952,8955,8970,8977,8978,8982,8983,8984,8985,8988,8990,8992,8995,8996,9001,9002,9003,9004,9005,9010,9017,9022,9034,9036,9037,9038,9039,9040,9043,9044,9045,9047,9060,9062,9064,9069,9084,9085,9086,9091,9092,9093,9094,9095,9097,9098,9100,9103,9106,9108,9109,9110,9112,9119,9125,9128,9129,9130,9132,9138,9139,9141,9142,9145,9150,9151,9152,9161,9162,9163,9166,9167,9170,9173,9174,9176,9177,9178,9179,9184,9186,9187,9188,9193,9194,9198,9201,9202,9203,9207,9208,9210,9213,9218,9220,9221,9224,9227,9228,9229,9230,9233,9236,9239,9245,9249,9251,9256,9257,9258,9271,9275,9276,9277,9281,9286,9311,9312,9313,9316,9317,9325,9326,9332,9335,9337,9339,9340,9342,9344,9347,9351,9355,9356,9357,9362,9368,9370,9373,9375,9381,9382,9384,9386,9387,9389,9390,9391,9392,9393,9400,9401,9404,9407,9410,9415,9420,9422,9426,9431,9436,9438,9443,9445,9449,9452,9453,9454,9457,9461,9462,9470,9473,9475,9477,9478,9481,9483,9487,9491,9492,9493,9501,9502,9504,9506,9516,9519,9520,9524,9526,9531,9533,9536,9539,9544,9545,9546,9548,9550,9551,9555,9558,9563,9567,9573,9576,9577,9579,9580,9581,9582,9583,9584,9598,9603,9608,9629,9630,9634,9635,9640,9642,9644,9645,9647,9655,9658,9660,9667,9669,9670,9671,9672,9673,9676,9682,9683,9689,9692,9694,9706,9709,9710,9723,9731,9736,9746,9747,9755,9756,9761,9763,9765,9772,9773,9777,9778,9795,9800,9802,9803,9804,9805,9806,9810,9815,9820,9821,9822,9828,9831,9832,9837,9838,9840,9841,9844,9847,9848,9856,9875,9884,9886,9889,9894,9905,9907,9910,9928,9930,9963,9969,9973,9974,9977,9981,9982,9991,9995,9997,10002,10004,10007,10020,10025,10029,10033,10037,10048,10050,10051,10074,10075,10076,10079,10083,10087,10088,10089,10096,10099,10105,10108,10117,10119,10123,10127,10128,10136,10144,10146,10148,10154,10159,10171,10172,10177,10183,10187,10188,10189,10191,10195,10199,10202,10206,10207,10225,10226,10233,10235,10236,10244,10247,10258,10259,10261,10267,10272,10273,10283,10290,10293,10300,10302,10321,10322,10327,10330,10331,10333,10337,10339,10343,10344,10347,10350,10353,10355,10358,10370,10382,10383,10386,10397,10398,10408,10414,10421,10436,10437,10445,10446,10448,10456,10458,10462,10473,10477,10480,10483,10489,10493,10498,10499,10500,10501,10510,10511,10513,10514,10531,10537,10540,10573,10576,10607,10614,10617,10618,10741,10810,10851,10885,10913,11051,11060,11062,11114,11174,11199,11202,11204,11208,11231,11427,11487,11498,11503,11543,11547,11559,11597,11659,11679,11685,11710,11760,11772,11853,11986,11999,12011,12017,12045,12158,12167,12217,12257,12367,12373,12391,12410,12429,12435,12447,12452,12510,12530,12557,12573,12600,12629,12640,12654,12662,12686,12736,12784,12791,12803,12828,12850,12854,12862,12928,12952,12968,13013,13091,13133,13219,13302,13334,13341,13371,13387,13412,13420,13441,13450,13604,13694,13703,13743,13863,13874,13888,13889,13896,13952,13981,14032,14184,14188,14252,14285,14298,14364,14371,14373,14378,14386,14436,14539,14584,14735,14757,14913,14914,14977,15048,15049,15137,15151,15265,15337,15374,15444,15458,15547,15772,16115,16121,16157,16162,16167,16241,16766,16930,16995,17047,17056,17110,17136,17212,17214,17223,17280,17287,17339,17371,17402,17521,17529,17568,17577,17882,17885,18012,18087,18088,18089,18153,18168,18203,18379,18609,18641,18966,18976,18993,19001,19055,19060,19063,19098,19206,19263,19279,19803,20202,20235,20261,20287,20292,20314,20329,20377,20466,20700,20824,20826,20844,20847,20861,20949,20959,21059,21062,21101,21167,21263,21365,21636,21642,21669,21718,21763,21862,21876,22065,22076,22147,22199,22219,22275,22314,22317,22361,22372,22418,22491,22522,22738,23140,23203,23267,23335,23354,23441,23442,23672,23829,24020,24091,24152,24516,24523,24615,24623,24774,24892,24937,25001,25072,25182,25277,25312,25814,25833,25860,25869,25923,26148,26300,26458,26487,26490,26546,26561,26599,26605,26670,26704,26725,26746,26747,26763,26771,26779,26787,26842,26845,26854,26871,26872,26965,26978,27014,27025,27075,27108,27121,27130,27133,27152,27222,27227,27257,27375,27386,27533,27797,27919,27950,27981,28006,28255,28260,28437,28593,28647,28660,28731,28818,29006,29102,29297,29460,29707,30406,30525,30577,30603,30625,30652,30664,30676,30839,30927,31173,31429,31553,31599,31625,31712,31861,31900,31942,31950,32250,32317,32389,32494,32635,32658,32682,32783,32802,32824,32859,32874,32887,33023,33136,33145,33255,33374,33487,33511,33525,33554,33629,33647,33804,33805,33892,33919,33934,33997,34138,34258,34281,34284,34333,34389,34390,34400,34416,34518,34679,34684,34851,34879,34924,34978,35145,35192,35275,35337,35364,35458,35513,35514,35533,35564,35606,35670,35679,35802,35808,35825,35894,36019,36190,36342,36360,36426,36485,36580,36611,36666,36748,36793,36924,36926,36952,36965,37155,37189,37225,37246,37264,37335,37453,37483,37536,37547,37629,37631,37715,37716,37749,37923,37936,37984,38112,38145,38150,38171,38172,38186,38190,38194,38320,38479,38495,38675,38769,39058,39159,39374,39731,39781,39800,39848,39852,40003,40048,40094,40100,40117,40218,40284,40341,40872,41186,41210,41244,41270,41349,41372,41393,41439,41496,41512,41523,41623,41727,41767,42183,42252,42270,42281,42344,42419,42586,42597,42729,42961,43049,43157,43291,43323,43545,43548,43755,43758,43771,43864,43874,43936,44015,44019,44107,44116,44331,44430,44431,44485,44668,45796,45816,45841,45927,45941,45965,45967,46236,46519,47249,47462,47532,48229,48364,48396,48454,48640,48853,48931,49046,49184,49248,49564,49813,50003,50109,50134,50392,50446,50702,50717,50760,50834,50847,50849,50853,51097,51127,51246,51369,51392,51466,51493,51533,51542,51560,51639,51720,51907,52095,52249,52374,52804,52822,52950,53139,53166,53184,53238,53335,53375,53382,53503,53516,53725,53788,54101,54217,54280,54662,55217,55267,55455,55497,55531,55533,55538,55571,55577,55676,55770,55836,55868,55947,55955,55974,56058,56129,56137,56214,56226,56310,56393,56400,56410,56468,56469,56483,56488,56495,56521,56527,56696,56893,57064,57117,57216,57227,57323,57337,57507,57584,57663,57716,57776,57827,57831,58184,58191,58321,58388,58423,58452,58710,58969,59036,59069,59211,59310,59445,59490,59525,59545,59568,59819,59968,60107,60149,60182,60200,60263,60282,60437,60464,60500,60528,60541,60586,60703,60781,60828,60842,60922,60923,60934,61074,61143,61194,61409,61412,61738,61752,61941,61951,62120,62375,62476,62493,62589,62644,62711,62738,62872,62975,63125,63139,63337,64263,64308,64335,64336,64411,64462,64506,64519,64697,64822,64974,65577,65770,65828,65831,65860,66149,66174,66355,66445,66461,66660,66663,67063,67254,67328,67354,67675,67829,67857,67873,67900,67995,68054,68065,68112,68148,68334,68462,68492,68560,68740,68803,68907,69023,69273,69373,69596,69636,69725,69830,69986,70532,70534,70607,70633,70713,70729,70730,70751,70967,71083,71134,71250,71253,71299,71359,71364,71397,71442,71563,71590,71717,71763,71774,71884,72135,72406,72454,72509,72568,72723,72750,72865,73532,73714,73881,73978,74015,74092,74250,74388,74692,74706,74772,74814,74952,75070,75240,75280,75286,75308,75392,75400,76139,76537,76696,76923,77056,77068,77357,77418,77607,77677,77762,78762,79362,79409,80367,80435,80481,80578,81047,81048,81187,81194,81354,81453,81494,81533,81584,81956,82147,82195,82488,82537,82590,82628,83153,83233,83262,83422,83489,83899,83987,84020,84141,84426,84663,84678,84732,85022,85411,85472,85645,85833,85977,86076,86096,86230,86231,86365,86431,86888,86990,87377,87911,88105,88158,88328,88512,88615,88785,89014,89232,89314,89329,89331,89967,90021,90221,90639,90714,90855,91349,91366,91596,91599,91654,91657,91799,91863,92299,92589,92742,92769,92862,92972,93007,93124,93132,93348,3641,4115,26810,54039,61723,65566,65949,66385,66610,67175,67268,67326,67390,67409,67816,68385,68759,70434,70435,70658,70745,72059,72919,72920,73901,73913,74212,74302,74735,74818,74867,75380,75911,76193,76840,77216,77258,77413,78780,78821,81381,81521,82630,82772,82827,82835,83043,83458,83471,83720,83915,84825,85019,85039,85137,85467,85469,85540,85725,85855,85856,86559,86801,87041,87606,87676,88008,88353,89032,89645,89694,89705,90096,90470,90505,90709,90820,90943,91414,91790,91885,93191");
	//surveySkippedScreeningIds.put("36","12153,12161,12164,12166,12171,12177,12183,12188,12189,12200,12203,12208,12219,12220,12227,12228,12229,12232,12235,12238,12244,12246,12247,12248,12249,12250,12251,12259,12262,12264,12265,12276,12278,12284,12285,12287,12290,12291,12294,12299,12300,12305,12306,12307,12309,12310,12312,12313,12315,12316,12317,12318,12319,12320,12327,12330,12334,12337,12339,12342,12350,12351,12356,12357,12362,12365,12366,12368,12371,12372,12374,12378,12379,12381,12382,12383,12390,12392,12397,12399,12401,12404,12405,12406,12407,12417,12418,12421,12422,12426,12427,12436,12437,12439,12440,12446,12461,12463,12464,12465,12472,12475,12479,12481,12484,12495,12503,12512,12517,12525,12529,12534,12540,12541,12543,12553,12558,12562,12563,12567,12568,12570,12572,12575,12577,12579,12580,12581,12587,12591,12592,12593,12594,12595,12596,12597,12601,12606,12609,12616,12617,12623,12625,12628,12631,12637,12638,12644,12648,12650,12653,12656,12659,12661,12668,12671,12683,12688,12690,12696,12702,12703,12704,12707,12709,12710,12711,12712,12714,12716,12717,12718,12719,12720,12721,12722,12723,12724,12725,12728,12729,12730,12731,12732,12733,12734,12735,12738,12739,12741,12742,12743,12744,12745,12746,12747,12748,12750,12751,12755,12756,12757,12758,12759,12760,12763,12764,12765,12767,12768,12769,12772,12773,12774,12777,12780,12785,12786,12788,12789,12790,12793,12801,12805,12808,12809,12812,12813,12815,12816,12818,12819,12821,12822,12823,12824,12826,12827,12829,12830,12832,12834,12838,12839,12840,12843,12845,12847,12848,12856,12861,12866,12869,12875,12876,12878,12880,12881,12884,12891,12892,12894,12895,12899,12907,12908,12909,12911,12912,12914,12916,12921,12924,12927,12929,12932,12934,12941,12942,12943,12944,12947,12951,12956,12964,12965,12966,12967,12974,12975,12976,12977,12978,12979,12984,12989,12990,12996,13000,13002,13009,13010,13012,13015,13018,13019,13021,13024,13025,13026,13029,13030,13031,13034,13036,13038,13042,13043,13050,13055,13058,13063,13067,13070,13073,13074,13075,13082,13085,13092,13093,13095,13099,13100,13101,13102,13104,13105,13108,13111,13115,13118,13119,13120,13122,13132,13137,13138,13141,13142,13144,13145,13146,13147,13148,13149,13152,13154,13155,13157,13163,13167,13172,13174,13175,13177,13178,13180,13182,13185,13187,13188,13189,13192,13193,13198,13199,13205,13206,13209,13210,13215,13217,13218,13224,13228,13234,13236,13237,13240,13241,13243,13244,13249,13250,13252,13254,13255,13259,13260,13262,13263,13265,13266,13267,13268,13269,13272,13279,13280,13285,13289,13290,13296,13297,13299,13303,13304,13308,13309,13320,13322,13324,13328,13329,13337,13340,13342,13343,13346,13348,13354,13357,13358,13362,13364,13365,13366,13367,13368,13369,13370,13373,13375,13376,13377,13383,13391,13396,13397,13399,13400,13402,13404,13406,13408,13409,13413,13419,13421,13423,13426,13429,13431,13432,13437,13444,13446,13447,13452,13455,13456,13458,13460,13461,13462,13464,13465,13466,13467,13468,13471,13472,13473,13479,13483,13485,13487,13489,13490,13491,13492,13493,13495,13498,13503,13504,13507,13508,13509,13512,13513,13514,13517,13518,13521,13525,13526,13528,13533,13535,13536,13540,13541,13542,13548,13549,13551,13559,13566,13567,13569,13570,13575,13577,13581,13585,13586,13588,13590,13593,13600,13603,13605,13607,13610,13615,13620,13621,13622,13627,13628,13629,13631,13632,13633,13634,13635,13637,13639,13640,13642,13643,13644,13648,13649,13652,13655,13657,13662,13663,13666,13671,13674,13678,13680,13682,13683,13685,13691,13693,13698,13702,13706,13707,13708,13709,13710,13712,13716,13718,13719,13720,13721,13722,13727,13728,13731,13734,13735,13738,13741,13742,13746,13748,13752,13753,13756,13757,13758,13759,13762,13767,13770,13772,13775,13776,13778,13779,13781,13783,13785,13786,13789,13790,13793,13797,13799,13800,13801,13803,13804,13807,13811,13812,13816,13818,13823,13826,13830,13832,13835,13841,13844,13847,13852,13853,13858,13861,13862,13867,13873,13879,13882,13890,13891,13892,13893,13899,13901,13902,13903,13907,13908,13909,13911,13913,13916,13918,13919,13923,13928,13930,13931,13938,13939,13940,13943,13944,13949,13953,13957,13960,13963,13966,13968,13974,13975,13980,13986,13989,13990,13996,14000,14002,14005,14006,14007,14013,14016,14019,14020,14021,14025,14029,14030,14034,14037,14038,14046,14052,14053,14055,14056,14061,14063,14069,14072,14073,14074,14082,14086,14088,14090,14093,14103,14104,14105,14108,14113,14116,14117,14119,14122,14127,14128,14130,14137,14138,14140,14141,14142,14143,14144,14145,14146,14147,14148,14152,14161,14164,14167,14168,14170,14171,14172,14174,14189,14191,14193,14194,14200,14209,14213,14214,14216,14221,14226,14227,14228,14238,14242,14244,14247,14250,14253,14254,14267,14274,14281,14291,14292,14293,14296,14300,14302,14306,14308,14310,14316,14324,14332,14336,14341,14362,14369,14372,14376,14387,14389,14392,14396,14397,14398,14399,14402,14405,14406,14407,14408,14410,14411,14413,14415,14418,14420,14421,14423,14424,14425,14428,14430,14431,14441,14445,14446,14448,14452,14453,14455,14458,14461,14469,14470,14476,14479,14480,14484,14489,14495,14497,14506,14507,14512,14517,14518,14519,14521,14523,14527,14530,14532,14534,14535,14536,14541,14545,14549,14550,14551,14553,14562,14563,14565,14569,14579,14583,14586,14587,14588,14589,14590,14591,14594,14598,14600,14603,14604,14607,14614,14617,14620,14630,14631,14637,14638,14639,14642,14643,14652,14654,14655,14656,14657,14658,14661,14667,14669,14670,14671,14678,14679,14683,14692,14693,14695,14696,14699,14702,14703,14706,14711,14712,14714,14717,14718,14719,14721,14722,14725,14727,14731,14732,14736,14741,14742,14745,14752,14756,14758,14759,14761,14764,14765,14766,14768,14769,14770,14771,14772,14776,14779,14784,14786,14788,14792,14793,14799,14803,14805,14806,14814,14828,14831,14833,14842,14847,14854,14855,14856,14862,14863,14866,14869,14870,14873,14875,14878,14879,14880,14883,14887,14889,14891,14892,14893,14894,14896,14899,14902,14904,14907,14908,14910,14912,14918,14919,14925,14926,14935,14936,14941,14942,14943,14944,14945,14951,14952,14955,14956,14958,14967,14978,14986,14988,14992,14998,15000,15005,15006,15007,15009,15017,15019,15021,15022,15024,15027,15030,15036,15037,15046,15050,15060,15061,15062,15064,15071,15075,15076,15080,15084,15086,15087,15088,15091,15098,15100,15102,15105,15106,15108,15115,15125,15127,15128,15130,15132,15133,15136,15140,15143,15146,15147,15150,15156,15162,15171,15172,15174,15175,15178,15183,15187,15194,15197,15199,15201,15209,15212,15216,15218,15225,15227,15231,15234,15243,15244,15249,15255,15267,15281,15284,15291,15295,15298,15302,15303,15304,15305,15306,15314,15320,15325,15327,15334,15346,15349,15350,15355,15370,15372,15376,15382,15386,15389,15396,15402,15406,15407,15409,15417,15424,15432,15433,15434,15435,15437,15439,15441,15450,15451,15452,15456,15464,15469,15471,15474,15475,15478,15480,15482,15484,15485,15493,15498,15501,15506,15511,15513,15514,15515,15516,15517,15518,15519,15522,15525,15529,15537,15542,15543,15544,15546,15550,15552,15553,15554,15555,15556,15559,15564,15565,15573,15574,15576,15577,15580,15581,15582,15591,15592,15593,15594,15597,15601,15602,15603,15610,15611,15612,15614,15617,15624,15626,15628,15629,15632,15634,15635,15636,15638,15640,15642,15643,15645,15646,15647,15648,15650,15654,15657,15660,15662,15663,15666,15667,15672,15673,15682,15688,15689,15692,15694,15695,15696,15697,15698,15699,15702,15703,15709,15710,15712,15716,15721,15723,15725,15726,15729,15731,15734,15737,15741,15743,15745,15748,15751,15753,15755,15760,15761,15762,15763,15764,15767,15771,15776,15777,15778,15781,15782,15784,15785,15788,15797,15798,15802,15803,15805,15807,15810,15811,15813,15814,15819,15820,15821,15828,15831,15837,15838,15839,15840,15842,15843,15850,15851,15852,15854,15856,15863,15864,15867,15873,15874,15876,15878,15880,15882,15885,15886,15887,15891,15937,15961,16007,16085,16107,16137,16144,16183,16280,16827,17008,17025,17039,17051,17105,17106,17141,17217,17220,17224,17419,17422,17664,17665,17687,17706,17778,17894,17981,17985,17991,18047,18118,18175,18186,18200,18201,18248,18341,18388,18418,18629,18712,18721,18796,18801,18803,18810,18921,18924,18997,19067,19121,19168,19222,19315,19334,19356,19500,19547,19587,19618,19741,19750,19770,19801,19856,20114,20128,20134,20149,20163,20166,20190,20212,20240,20275,20310,20685,20746,20925,21034,21045,21077,21093,21189,21233,21430,21433,21458,21493,21568,21572,21590,21601,21612,21613,21674,21691,21771,21775,21822,21915,21959,21964,22054,22088,22102,22204,22242,22319,22374,22389,22411,22569,22579,22693,22805,22828,22909,22947,23338,23444,23464,23501,23599,23627,23815,23830,23964,24013,24019,24078,24134,24205,24292,24334,24355,24560,24583,24636,24649,24903,24933,24935,25022,25039,25134,25327,25345,25455,25516,25528,25632,25668,25958,26033,26056,26111,26120,26235,26253,26377,26452,26512,26517,26518,26630,26640,26641,26662,26673,26692,26694,26699,26744,26780,26784,26792,26833,26887,26890,26909,26933,26980,26987,27078,27126,27129,27172,27189,27269,27365,27593,27627,27685,27691,27695,27725,27775,27795,27798,27816,28024,28034,28160,28170,28192,28230,28373,28401,28440,28555,28734,28829,28855,28886,28947,28983,29037,29061,29130,29165,29172,29322,29576,29586,29631,29675,29747,29795,29806,29819,29832,29948,30020,30028,30034,30072,30135,30161,30183,30186,30244,30365,30378,30405,30458,30486,30492,30496,30526,30527,30531,30593,30650,30661,30692,30721,30726,30733,30746,30759,30774,30833,30840,30841,30950,31065,31080,31202,31229,31267,31280,31302,31361,31423,31619,31670,31766,31855,31860,32035,32050,32238,32283,32293,32362,32378,32401,32434,32468,32484,32599,32640,32670,32691,32740,32819,32956,33323,33406,33446,33468,33523,33571,33572,33638,33655,33657,33855,34121,34142,34151,34156,34196,34210,34278,34301,34307,34309,34310,34314,34351,34358,34405,34407,34671,34775,34794,34895,34899,34920,34956,35030,35032,35061,35111,35252,35283,35322,35328,35354,35431,35511,35576,35604,35774,35983,36098,36120,36166,36232,36445,36489,36504,36594,36684,36695,36705,36821,36890,36943,36967,36970,36983,36992,36998,37007,37028,37051,37058,37093,37144,37170,37271,37300,37341,37347,37365,37366,37368,37382,37383,37493,37540,37621,37622,37744,37782,37784,37785,37788,37853,37924,37942,38060,38125,38126,38179,38203,38242,38289,38308,38331,38531,38569,38659,38741,38773,38891,38935,39113,39118,39147,39275,39305,39308,39426,39712,39899,40049,40086,40132,40196,40240,40275,40401,40663,40718,40777,40960,41063,41065,41081,41091,41147,41181,41243,41339,41522,41545,41654,41719,41787,41817,41958,41977,42028,42062,42138,42157,42169,42413,42475,42512,42627,42655,42703,42769,42822,42846,42885,42973,42990,43079,43085,43087,43124,43283,43325,43410,43598,43634,43659,43702,43875,44041,44613,44642,44808,44809,44911,44938,44976,44981,45022,45055,45122,45142,45176,45193,45218,45230,45231,45280,45294,45305,45331,45341,45410,45436,45492,45498,45718,45749,45838,45920,45940,45986,46008,46019,46147,46152,46178,46277,46340,46466,46480,46513,46544,46578,46652,46696,46705,46780,46804,47156,47441,47551,47572,47794,47851,47898,47918,48145,48298,48406,48602,48930,48938,49301,49356,49472,49608,49986,49988,49989,50049,50053,50082,50236,50242,50276,50280,50315,50352,50357,50525,50552,50588,50703,50730,51007,51008,51030,51052,51155,51181,51373,51491,51545,51613,51659,51748,51759,51820,51935,51976,52032,52040,52073,52463,52573,52577,52645,52676,52741,52839,52865,52893,52964,53480,53525,53624,53636,53646,53773,53774,53847,54072,54207,54393,54466,54509,54516,54630,54655,54687,54964,55001,55003,55158,55171,55173,55356,55439,55457,55461,55740,55862,55890,56068,56110,56248,56251,56286,56321,56356,56363,56421,56449,56491,56510,56556,56562,56616,56625,56659,56676,56809,56838,56876,56907,56924,56956,57106,57174,57420,57423,57575,57798,57819,57823,57841,57878,57927,57931,57953,57973,57981,58049,58168,58194,58320,58528,58680,58916,58942,58951,59101,59456,59600,59634,59770,59937,59957,60069,60091,60185,60190,60237,60365,60371,60397,60401,60413,60658,60801,60885,60888,61228,61260,61261,61340,61367,61428,61460,61468,61489,61513,61564,61627,61682,61705,61707,61728,61800,61843,61877,62042,62062,62246,62279,62295,62308,62325,62693,62778,63153,63160,63205,63331,63372,63385,63389,63398,63404,63542,63608,63674,63718,63732,63747,63751,63778,63783,63829,63837,63859,63877,63896,63899,63949,64002,64029,64039,64105,64183,64216,64225,64237,64242,64277,64300,64319,64360,64367,64374,64416,64433,64480,64487,64593,64640,64792,64870,64877,64961,65022,65278,65358,65377,65382,65494,65507,65508,65524,65570,65691,65768,65889,65890,65918,65944,66061,66116,66194,66202,66203,66246,66305,66347,66354,66357,66367,66381,66512,66556,66558,66581,66632,66858,66962,67012,67016,67022,67052,67125,67228,67277,67325,67432,67440,67451,67514,67521,67541,67546,67569,67581,67632,67661,67662,67671,67680,67807,67836,67855,67869,67874,67905,67908,67909,67951,67957,67964,67969,68053,68090,68096,68129,68159,68232,68239,68253,68287,68293,68298,68310,68321,68353,68361,68426,68471,68496,68498,68508,68543,68545,68550,68561,68668,68685,68703,68707,68710,68719,68769,68801,68877,68882,68892,68894,68934,68943,68955,68996,69007,69122,69133,69136,69163,69260,69405,69483,69512,69519,69523,69557,69608,69611,69721,69741,69784,69899,69915,70089,70091,70095,70209,70210,70284,70335,70340,70364,70407,70408,70409,70410,70445,70476,70479,70642,70661,70693,70702,70774,70799,70813,70833,70837,70839,70910,70917,70957,70959,70984,70994,71029,71050,71051,71061,71133,71164,71238,71247,71259,71285,71308,71309,71329,71356,71376,71377,71388,71450,71451,71482,71502,71533,71534,71555,71558,71625,71636,71637,71731,71733,71737,71757,71770,71795,71803,71806,71807,71856,71870,71926,71929,71946,71950,71967,71968,72001,72054,72066,72098,72105,72118,72124,72125,72126,72136,72165,72217,72218,72224,72273,72275,72434,72472,72477,72486,72516,72534,72579,72609,72612,72614,72696,72697,72759,72795,72870,72894,72922,72928,72951,72961,72970,73012,73028,73032,73035,73039,73040,73058,73115,73120,73121,73122,73123,73149,73150,73175,73183,73211,73297,73304,73317,73328,73347,73385,73425,73436,73454,73458,73466,73467,73480,73490,73514,73538,73539,73542,73569,73573,73588,73628,73658,73664,73666,73669,73690,73695,73731,73738,73778,73791,73813,73816,73824,73835,73843,73853,73874,73875,73880,73920,73924,73928,73930,73937,73948,74017,74019,74024,74025,74043,74106,74116,74117,74120,74152,74190,74196,74247,74290,74300,74314,74331,74345,74354,74360,74371,74375,74381,74393,74432,74484,74488,74492,74499,74542,74551,74593,74617,74624,74649,74653,74687,74696,74741,74779,74793,74846,74860,74861,74862,74872,74881,74900,74902,74959,74987,75014,75030,75041,75087,75112,75116,75156,75170,75171,75174,75177,75218,75220,75323,75326,75334,75336,75385,75391,75393,75411,75423,75451,75460,75491,75501,75562,75570,75571,75667,75686,75693,75710,75713,75741,75772,75797,75815,75845,75865,75879,75901,75921,75950,75974,75977,76007,76017,76122,76203,76247,76278,76295,76301,76303,76318,76377,76385,76401,76424,76425,76431,76467,76469,76511,76512,76528,76548,76557,76580,76633,76652,76714,76845,76858,76886,76916,76920,76927,76933,76938,76939,76946,76947,76948,76963,77001,77063,77108,77128,77150,77152,77184,77188,77204,77210,77285,77299,77301,77308,77350,77370,77376,77380,77386,77406,77408,77431,77435,77441,77465,77468,77500,77501,77523,77589,77593,77595,77600,77623,77637,77678,77736,77776,77880,77886,77893,77990,77993,77994,77997,78028,78029,78053,78096,78097,78130,78137,78153,78165,78166,78177,78214,78268,78285,78331,78362,78384,78435,78518,78521,78563,78577,78660,78707,78738,78748,78752,78758,78775,78779,78823,78868,78880,78899,78908,78910,78929,78951,78963,79022,79029,79040,79047,79068,79072,79078,79081,79091,79113,79121,79132,79170,79177,79216,79234,79261,79270,79275,79360,79364,79366,79378,79398,79408,79414,79427,79432,79443,79464,79466,79483,79487,79503,79505,79516,79559,79604,79668,79710,79738,79745,79771,79786,79796,79806,79863,79915,79930,79976,79985,79990,80149,80153,80158,80172,80218,80248,80254,80273,80296,80327,80335,80358,80360,80365,80369,80406,80430,80446,80497,80524,80526,80531,80538,80557,80574,80633,80638,80641,80642,80654,80671,80677,80680,80718,80728,80758,80780,80826,80837,80869,80884,80890,80926,80927,80959,80978,81002,81010,81071,81081,81094,81112,81139,81163,81175,81203,81226,81270,81275,81297,81303,81319,81335,81339,81341,81348,81360,81377,81384,81391,81395,81398,81410,81419,81433,81436,81447,81451,81470,81534,81540,81544,81545,81555,81561,81577,81599,81611,81618,81627,81635,81638,81645,81648,81659,81661,81687,63687,64775,68123,68712,69049,69661,70389,71976,73940,73970,74689,75165,75432,75458,76523,77399,77682,77737,78008,78298,79361,79662,79932,79986,80454,80618,80687,80962,81200,81302,81610,81642,81656,81714,81729,81738,81753,81769,81772,81774,81789,81790,81793,81796,81799,81802,81818,81821,81831,81834,81836,81840,81851,81852,81853,81860,81868,81873,81879,81884,81887,81892,81895,81902,81905,81906,81909,81946,81957,81960,81964,81971,81982,81990,82023,82044,82055,82060,82061,82089,82108,82121,82139,82155,82157,82185,82190,82200,82202,82214,82232,82237,82242,82255,82265,82266,82268,82276,82305,82311,82335,82357,82374,82390,82410,82412,82419,82433,82461,82473,82475,82485,82519,82525,82530,82601,82616,82669,82678,82683,82698,82701,82703,82717,82778,82781,82782,82839,82855,82858,82871,82884,82889,82892,82904,82910,82912,82934,82957,82962,82970,82974,82977,82981,82990,82993,82995,83027,83033,83044,83047,83059,83070,83073,83135,83141,83158,83172,83175,83209,83217,83247,83251,83254,83259,83261,83284,83285,83289,83313,83323,83335,83336,83349,83373,83375,83383,83405,83413,83435,83443,83445,83460,83474,83478,83530,83533,83535,83587,83611,83668,83670,83671,83674,83685,83694,83699,83704,83784,83790,83791,83802,83832,83835,83879,83895,83912,83914,83916,83917,83919,83936,83948,83955,83981,83989,84032,84059,84064,84083,84094,84099,84101,84117,84131,84142,84164,84167,84222,84229,84256,84262,84263,84292,84294,84295,84298,84319,84344,84347,84359,84365,84372,84396,84402,84422,84469,84473,84486,84494,84505,84507,84513,84518,84519,84524,84539,84550,84568,84577,84608,84612,84618,84637,84668,84681,84745,84761,84766,84768,84783,84831,84909,84912,84919,84925,84929,84954,84961,84967,84975,84984,85010,85060,85061,85081,85085,85127,85128,85134,85140,85158,85181,85182,85189,85192,85197,85218,85240,85247,85256,85292,85303,85309,85310,85311,85317,85321,85355,85368,85369,85389,85417,85421,85451,85502,85571,85576,85611,85624,85679,85696,85709,85712,85717,85785,85804,85811,85812,85819,85835,85859,85887,85900,85914,85915,85917,85965,85978,85979,86002,86008,86014,86015,86043,86044,86048,86055,86067,86087,86095,86097,86145,86155,86164,86188,86199,86200,86201,86209,86225,86234,86243,86246,86254,86271,86280,86283,86285,86287,86297,86304,86317,86319,86323,86332,86343,86345,86362,86375,86376,86392,86403,86442,86453,86457,86466,86479,86499,86519,86527,86558,86561,86566,86574,86594,86596,86623,86624,86654,86678,86703,86707,86717,86718,86731,86732,86751,86800,86827,86830,86832,86834,86838,86880,86881,86902,86903,86904,86908,86909,86917,86930,86955,86958,86963,86992,86996,86998,87005,87016,87019,87028,87055,87113,87115,87123,87169,87178,87220,87258,87268,87282,87301,87324,87327,87334,87337,87346,87349,87350,87371,87375,87383,87387,87410,87420,87450,87456,87458,87472,87478,87493,87511,87526,87533,87636,87649,87659,87705,87708,87713,87721,87724,87771,87779,87799,87800,87803,87816,87832,87835,87851,87854,87856,87871,87884,87901,87926,87952,87977,87981,87984,88048,88072,88075,88082,88093,88100,88123,88135,88144,88151,88152,88182,88184,88187,88192,88202,88225,88264,88272,88296,88305,88309,88310,88317,88318,88334,88337,88391,88396,88406,88444,88467,88490,88491,88500,88505,88526,88544,88545,88548,88565,88577,88579,88583,88599,88600,88613,88614,88671,88672,88674,88679,88762,88770,88790,88800,88854,88865,88866,88881,88904,88921,88928,88940,88943,88944,88948,88973,88990,88995,89035,89044,89053,89075,89084,89092,89150,89151,89152,89158,89167,89174,89175,89186,89191,89219,89244,89266,89275,89287,89292,89330,89388,89392,89417,89451,89453,89466,89475,89476,89488,89489,89503,89509,89518,89523,89532,89536,89580,89592,89604,89625,89635,89637,89664,89673,89677,89686,89695,89722,89765,89772,89785,89792,89810,89814,89827,89833,89846,89850,89872,89910,89915,89929,89932,89950,89956,90023,90040,90062,90063,90151,90161,90165,90169,90175,90198,90205,90209,90235,90236,90244,90266,90303,90304,90322,90355,90366,90398,90402,90403,90431,90433,90440,90485,90499,90501,90517,90531,90535,90541,90561,90563,90569,90576,90589,90592,90598,90611,90615,90652,90655,90666,90671,90688,90694,90697,90710,90720,90733,90742,90745,90751,90765,90770,90772,90821,90847,90882,90890,90905,90934,90961,90976,91004,91011,91021,91080,91089,91090,91108,91111,91123,91132,91228,91310,91329,91336,91348,91352,91382,91385,91386,91388,91396,91400,91403,91441,91448,91461,91471,91500,91507,91509,91527,91535,91551,91559,91570,91605,91637,91650,91653,91675,91680,91684,91718,91723,91725,91739,91777,91805,91825,91850,91861,91874,91875,91880,91892,91932,91943,91986,91989,91999,92007,92008,92011,92025,92036,92082,92115,92143,92158,92161,92239,92248,92256,92257,92306,92312,92348,92359,92374,92379,92411,92421,92436,92448,92458,92461,92467,92468,92505,92516,92544,92593,92600,92611,92618,92665,92671,92712,92732,92733,92784,92789,92797,92819,92855,92868,92876,92893,92897,92916,92919,92930,92956,92969,93000,93009,93013,93042,93045,93051,93062,93081,93083,93110,93123,93126,93127,93131,93150,93159,93165,93178,93196,93218,93219,93225,93227,93254,93269,93277,93302,93308,93310,93311,93313,93329,93331,93333,93334,93337,93338,93340,93343,93352,93355,93363,93372,93376,93382,93388,93394,93398,93412,93420,93422,93428,93452,93455,93474,93476,93478,93490,93495,93497,93506,93510,93511,93513,93520,93524,93526,93532,93537,93538,93540,93548,93556,93557,93564,93583,93584,93592,93597,93598,93599,93614,93633,93636,93643,93660,93663,93689,93718,93719,93726,93728,93730,93756,93760,93765,93769,93776,93794,93805,93811,93819,93883,93915,93920,93927,93929,93936,93941,93944,93953,93955,93958,93974,94001,94005,94012,94018,94020,81728,81791,81885,82022,82057,82204,82267,82498,82588,84553,84841,85306,85486,85847,85861,85897,86009,86115,86505,86606,87149,88417,88882,89125,89492,89852,90224,90352,90562,90703,91199,91406,91700,92015,92896,92920,92950,93030,93529,93655,93942");

	}

	Map<String, Object> jsonAsMap = null;
	private String endpointUrl = null;

	@BeforeClass
	public void setup() {
		RestAssured.baseURI = prop.getProperty("stage3url");
		RestAssured.useRelaxedHTTPSValidation();
		endpointUrl = prop.getProperty("serviceApi2");
		System.out.println("api url:"+endpointUrl);

	}

	private Map<String, String> getMigratedDataMap(String token) {
		System.out.println(
				"$$$$$$$$$$Survey No: " + surveyid + " token id: " + token + " $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$");
		Response resp = given().param("survey_id", surveyid).and().param("token_id", token).when()
				.contentType(ContentType.JSON).get(endpointUrl).then().assertThat().statusCode(200).and()
				.contentType(ContentType.JSON).and().extract().response();
		
		System.out.println("status code for tokenid-->" + token + " is: " + resp.getStatusCode());
		System.out.println("response for tokenid-->" + token + " is: " + resp.asString());

		JsonPath jPath = new JsonPath(resp.asString());

		ArrayList<String> answeredQtns = jPath.get("message.answeredQuestions");
		JSONArray answersArray = new JSONArray(answeredQtns);
		Map<String, String> hmp = new HashMap<>();

		for (int i = 0; i < answersArray.length(); i++) {
			String qtnTitle = answersArray.getJSONObject(i).get("title").toString();
			System.out.println("Main Question title:" + qtnTitle);

			JSONArray subQtns = (JSONArray) answersArray.getJSONObject(i).get("subQuestions");

			if (subQtns.length() > 0) {
				// add the sub qtns to the Map
				for (int j = 0; j < subQtns.length(); j++) {
					JSONObject subQtn = (JSONObject) subQtns.getJSONObject(j);

					if (surveyid.equals("106")) {
						String title = subQtn.getString("title");
						if ("SQ6876451,SQ6876562,SQ6876773,SQ6876984,SQ6877095,SQ6771101,SQ6772112"
								.indexOf(title) > -1) {
							continue;
						}
					}

					if (subQtn.has("submittedResponse")) {
						hmp.put(subQtn.getString("title"), subQtn.getString("submittedResponse"));
					}
				}
			} else {
				JSONObject qtn = (JSONObject) answersArray.getJSONObject(i);
				if (qtn.has("submittedResponse")) {
					hmp.put(qtn.getString("title"), qtn.getString("submittedResponse"));
				}
			}
		}

		return hmp;
	}

	@Test
	public void fetchSubmitedResponseTest() throws InterruptedException, Exception {
		int cnt = 1;
		System.out.println(
				"********Starting Validation for *Survey -" + surveyid + " " + cnt + " iteration started **********");
		Map<String, Map<String, String>> srchmp = new ExcelUtil().readDataAsKeyValue(trivoxSurveyDataFilePath,"survey-206", metadata_fpath, surveyid); // TODO

		Set<String> skippedScreeningIds = new HashSet<>(
				Arrays.asList(surveySkippedScreeningIds.get(surveyid).split(",")));

		// iterate through source data and compare with the migrated data
		for (String token : srchmp.keySet()) {
			String currentScreeningId = token.split("_")[0];

			if (skippedScreeningIds.contains(currentScreeningId)) {
				System.out.println("Skipped the screening Id:" + currentScreeningId);
				continue;
			}

			Map<String, String> hmp = getMigratedDataMap(token);

			// System.out.prin"------------------Start of Target
			// Map-----------------------------------------------------");
			Map<String, String> sorteddestinationMap = new TreeMap<String, String>(hmp);
			System.out.println("sorted destination map is-->" + sorteddestinationMap);
			// System.out.println("----------------End of Target
			// Map-----------------------------------------------------");
			// System.out.println("------------------------Start of Source
			// Map-----------------------------------------------------");
			Map<String, String> sortedsourceMap = new TreeMap<String, String>(srchmp.get(token));
			System.out.println("sorted source map is-->" + sortedsourceMap);
			// System.out.println( "---------------------End of Source
			// Map-------------------------------------------------------");
			checkEquality(currentScreeningId, sortedsourceMap, sorteddestinationMap);
			// System.out.println("result map -->" + new TreeMap(resultMap));
			// System.out.println( "------------------------End of result
			// Map-------------------------------------------------------");
			System.out.println("End of Iteration for survey No: " + surveyid + "  Token Id: " + token
					+ "  Iteration count: " + cnt + " out of " + srchmp.size());
			System.out.println("************************************************************");
			cnt++;
		}

	}

	private void checkEquality(String screeningId, Map<String, String> first, Map<String, String> second) {
		Map<String, String> unmatchedValues = first.entrySet().stream()
				.filter(e -> !e.getValue().equals(second.get(e.getKey())))
				.collect(Collectors.toMap(e -> e.getKey(), e -> e.getValue()));

		if (unmatchedValues.size() > 0) {
			System.out.println("++++++++++There are unmatched values in the screening Id:" + screeningId);

			for (String key : unmatchedValues.keySet()) {
				System.out.println("Unmatched SRC key :" + key + " Unmatched SRC Value:" + unmatchedValues.get(key));
				System.out.println("Unmatched DEST key :" + key + " Unmatched DEST Value:" + second.get(key));
			}
		} else {
			System.out.println("All is well in screening Id :" + screeningId);
		}
	}

}